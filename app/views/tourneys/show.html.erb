<div class="container-flex">
  <div class="left" id="info">
    <h1>Tourney</h1>
    <br>
    <div class="info-tourney">
      <%= render "info_tourney" %>
    </div>
    <br>
    <!-- EDIT -->
    <% if current_user %>
      <% if current_user.id == @tourney.user.id %>
        <%= link_to(edit_tourney_path(@tourney), remote: true) do %>
          <div class="button-current edit centered"><span class=icon-pencil2></span></div>
        <% end %>
      <% end %>
    <% end %>
  </div>
  <!-- EQUIPOS -->
  <div class="right" id="tabla">
    <h1 style="margin-left: 30px;">Teams</h1>
    <br>
    <table class="tabla">
      <thead>
        <tr>
          <th>Name</th>
          <th>Trainer</th>
          <th>Perfil</th>
          <% if current_user and current_user.id? %>
          <% if current_user.id == @tourney.user.id %>
            <th colspan="1"></th>
          <% end %>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @tourney.teams.each do |team| %>
          <tr class="no-link">
            <td><%= team.name %></td>
            <td><%= team.trainer %></td>
            <td class="value" id="cell-link">
              <%= link_to(team_path(team)) do %>
                <span class="icon-go2" style="margin-right: 5px;"></span>Go
              <% end %>
            </td>
            <% if current_user and current_user.id? %>
            <% if current_user.id == @tourney.user.id %>
            <% team_id = team.id %>
            <td class="value" id="cell-link">
                <%= link_to(tourney_participant_path(@tourney, team_id),
                method: :delete, data: { confirm: 'Are you sure?' }) do %>
                  <span class="icon-go2" style="margin-right: 5px;"></span>Remove
                <% end %>
            </td>
            <% end %>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
    <br>
    <!-- AGREGAR EQUIPOS AL TORNEO -->
    <% if current_user and current_user.id? %>
      <% if current_user.id == @tourney.user.id %>
      <% teams_select = Team.all - @tourney.teams %>
      <% if teams_select.length != 0 %>
        <h2 style="margin-left: 30px;">Add team to tourney:</h2>
        <br>
        <div style="text-align: center;">
          <%= form_for @tourney, url: tourney_participants_path(@tourney, :team_id), method: "post" do %>
            <%= select_tag(:team_id, options_from_collection_for_select(teams_select.collect, :id, :name), include_blank: true, required: true) %>
            <%= submit_tag("Add") %>
        </div>
      <% end %>
      <% end %>
      <% end %>
    <% end %>
    <br>
    <!-- CREAR PARTIDO EN TORNEO -->
    <% if current_user and current_user.id? %>
      <% if current_user.id == @tourney.user.id %>
        <% if @tourney.teams.length > 1 %>
        <h2 style="margin-left: 30px;">Create match:</h2>
        <%= render 'matches/form' %>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>

<!-- TABLA DE PARTIDOS -->
<h1 style="margin-left: 30px;">Calendario</h1>
<br>
<table class="tabla container-matches">
  <thead>
    <tr>
      <th>Date</th>
      <th>Home</th>
      <th>Aaway</th>
      <% if @tourney.format == 'Playoffs' %>
        <th>Bracket Code</th>
      <% end %>
      <% if current_user and current_user.id? %>
      <% if current_user.id == @tourney.user.id %>
      <th colspan="2"></th>
      <% end %>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @tourney.matches.each do |match| %>
      <% if match.home_team.present? %>
         <%= render "matches/match_tourney_display", match: match %>
      <% end %>
    <% end %>
  </tbody>
</table>
<br>

<!-- TABLA POSICIONES -->
<% if @tourney.format == 'Torneo' %>
  <div class="container-position-table">
    <%= render 'position_table' %>
  </div>
<% end %>

<!-- TABLA RESULTADOS -->
<div class="container-resultados">
  <%= render 'results' %>
</div>

<!-- Brackets -->
  <div class="container-brackets">
  <% if @tourney.format == 'Playoffs' %>
    <%= render 'brackets' %>
  <% end %>
  </div>

<%= link_to tourneys_path do %>
  <div class="button-back">
    <span class="icon-back"></span>
  </div>
<% end %>

<!-- Edit Match -->
<div class="modal-background edit-match">
  <div class="container-edit-match" style="width: 80%;">
    <div class="close">
      <span class=icon-delete></span>
    </div>
    <div class="edit-info-match">
    </div>
    <br>
  </div>
</div>

<!-- Edit Tourney -->
<div class="modal-background edit-tourney">
  <div class="container-edit-tourney">
    <div class="close">
      <span class=icon-delete></span>
    </div>
    <div class="edit-info-tourney">
    </div>
    <br>
  </div>
</div>
